(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{21:function(t,e,r){},24:function(t,e,r){},27:function(t,e,r){},28:function(t,e,r){},29:function(t,e,r){},30:function(t,e,r){},31:function(t,e,r){"use strict";r.r(e);var n=r(1),a=r(0),s=r.n(a),c=r(10),u=r.n(c),o=(r(21),r(2)),i=r.n(o),l=r(4),d=r(3),b=r(12),p={headers:{"Content-Type":"application/json",credentials:"include",mode:"cors"}},j=function(){var t=Object(l.a)(i.a.mark((function t(e,r){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(b.a)(Object(b.a)({},p),r),t.prev=1,t.next=4,fetch(e,r);case 4:return n=t.sent,t.next=7,n.json();case 7:return a=t.sent,t.abrupt("return",{status:n.statusText,data:a});case 11:return t.prev=11,t.t0=t.catch(1),console.log(t.t0),t.abrupt("return",{status:"Error",data:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"});case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,r){return t.apply(this,arguments)}}(),f="/api/profile";function h(){return O.apply(this,arguments)}function O(){return(O=Object(l.a)(i.a.mark((function t(){var e,r,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"GET",e={method:"GET"},t.next=4,j(f,e);case 4:if("OK"!==(r=t.sent).status){t.next=8;break}return n=r.data,t.abrupt("return",{status:"OK",data:n});case 8:return t.abrupt("return",{status:"ERROR",error:r.data.error});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m=r(14),v=r(15),x=r(5),_=function(){function t(){Object(m.a)(this,t),this.id=null,this.username=null,this.color=null,this.rounds=[],this.categories=[],Object(x.d)(this)}return Object(v.a)(t,[{key:"login",value:function(t,e,r){this.id=t,this.username=e,this.color=r}},{key:"logout",value:function(){this.id=null,this.username=null,this.color=null}},{key:"updateBattleData",value:function(t,e){this.rounds=t,this.categories=e}},{key:"getRound",value:function(t){return this.rounds.find((function(e){return e.id===t}))}},{key:"isAuth",get:function(){return!!this.id}}]),t}(),g=s.a.createContext({}),y=new _,k=function(t){var e=t.children;return Object(n.jsx)(g.Provider,{value:y,children:e})},N=function(){return Object(a.useContext)(g)},w=r(7),S=(r(24),"/api/login");function R(t,e){return K.apply(this,arguments)}function K(){return(K=Object(l.a)(i.a.mark((function t(e,r){var n,a,s,c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={username:e,password:r},a=JSON.stringify(n),"POST",s={method:"POST",body:a},t.next=6,j(S,s);case 6:if("OK"!==(c=t.sent).status){t.next=10;break}return u=c.data,t.abrupt("return",{status:"OK",data:u});case 10:return t.abrupt("return",{status:"ERROR",error:c.data.error});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var E=function(){var t=N(),e=Object(d.g)(),r=Object(a.useState)(""),s=Object(w.a)(r,2),c=s[0],u=s[1],o=Object(a.useState)(""),b=Object(w.a)(o,2),p=b[0],j=b[1],f=Object(a.useState)(null),h=Object(w.a)(f,2),O=h[0],m=h[1],v=function(){var r=Object(l.a)(i.a.mark((function r(n){var a,s,u,o,l;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.next=3,R(c,p);case 3:"OK"===(a=r.sent).status?(s=a.data,u=s.id,o=s.username,l=s.color,t.login(u,o,l),e("/")):m(a.error);case 5:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),x=[{name:"username",placeholder:"Username",type:"text",changeHook:function(t){return u(t.target.value)}},{name:"password",placeholder:"Password",type:"password",changeHook:function(t){return j(t.target.value)}}].map((function(t,e){var r=t.name,a=t.placeholder,s=t.type,c=t.changeHook;return Object(n.jsx)("div",{className:"login-form__input-block",children:Object(n.jsx)("input",{required:!0,type:s,name:r,placeholder:a,onChange:c,className:"login-form__input"})},e)}));return Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsx)("h1",{children:"Enter ZPK"}),Object(n.jsxs)("form",{className:"login-form",onSubmit:v,children:[x,Object(n.jsx)("span",{className:"login-form__error",children:O}),Object(n.jsx)("button",{className:"login-form__button",children:"Log In"})]})]})},T=r(8),I="/api/battle-data";function C(){return P.apply(this,arguments)}function P(){return(P=Object(l.a)(i.a.mark((function t(){var e,r,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"GET",e={method:"GET"},t.next=4,j(I,e);case 4:if("OK"!==(r=t.sent).status){t.next=8;break}return n=r.data,t.abrupt("return",{status:"OK",data:n});case 8:return t.abrupt("return",{status:"ERROR",error:r.data.error});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var D="/api/logout";function A(){return J.apply(this,arguments)}function J(){return(J=Object(l.a)(i.a.mark((function t(){var e,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"POST",e={method:"POST"},t.next=4,j(D,e);case 4:if("OK"!==(r=t.sent).status){t.next=7;break}return t.abrupt("return",{status:"OK"});case 7:return t.abrupt("return",{status:"ERROR",error:r.data.error});case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var B="/api/submit-track";function G(t,e){return L.apply(this,arguments)}function L(){return(L=Object(l.a)(i.a.mark((function t(e,r){var n,a,s,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={roundId:e,name:r},a=JSON.stringify(n),"POST",s={method:"POST",body:a},t.next=6,j(B,s);case 6:if("OK"!==(c=t.sent).status){t.next=9;break}return t.abrupt("return",{status:"OK"});case 9:return t.abrupt("return",{status:"ERROR",error:c.data.error});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var U="/api/toggle-rate";function H(t,e,r){return q.apply(this,arguments)}function q(){return(q=Object(l.a)(i.a.mark((function t(e,r,n){var a,s,c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={roundId:e,categoryId:r,trackId:n},s=JSON.stringify(a),"POST",c={method:"POST",body:s},t.next=6,j(U,c);case 6:if("OK"!==(u=t.sent).status){t.next=9;break}return t.abrupt("return",{status:"OK"});case 9:return t.abrupt("return",{status:"ERROR",error:u.data.error});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}r(27);var M=Object(T.a)((function(t){var e=t.roundId,r=N(),a=r.getRound(e),s=function(){var t=Object(l.a)(i.a.mark((function t(e,n,a){var s,c,u,o,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.isAuth){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,H(e,n,a);case 4:if("OK"!==(s=t.sent).status){t.next=12;break}return t.next=8,C();case 8:"OK"===(c=t.sent).status?(u=c.data,o=u.categories,l=u.rounds,r.updateBattleData(l,o)):console.log(c.error),t.next=13;break;case 12:console.log(s.error);case 13:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),c=a.tracks.map((function(t){return Object(n.jsxs)("div",{className:"round-table__item",children:[Object(n.jsx)("span",{className:"round-table__username",style:{color:t.userColor},children:t.userUsername}),Object(n.jsx)("span",{className:"round-table__track-name",children:t.name})]})})),u=r.categories.map((function(t){var r=a.tracks.map((function(r){var a=r.rates.filter((function(e){return e.categoryId===t.id})).map((function(t){return Object(n.jsx)("span",{className:"round-table__rate",style:{color:t.userColor},title:t.userUsername,children:"+"})}));return Object(n.jsx)("div",{className:"round-table__item round-table__item-rate",onClick:function(){s(e,t.id,r.id)},children:a})}));return Object(n.jsxs)("div",{className:"round-table__row",children:[Object(n.jsx)("div",{className:"round-table__category",children:t.name}),r]})})),o=a.tracks.map((function(t){var e=t.rates.length;return Object(n.jsx)("div",{className:"round-table__item round-table__total-rates",children:e})}));return Object(n.jsx)("div",{className:"round-table-block",children:Object(n.jsxs)("div",{className:"round-table",children:[Object(n.jsxs)("div",{className:"round-table__row-header",children:[Object(n.jsx)("div",{className:"round-table__category"}),c]}),u,Object(n.jsxs)("div",{className:"round-table__row",children:[Object(n.jsx)("div",{className:"round-table__category"}),o]})]})})})),Z=(r(28),Object(T.a)((function(t){var e=t.roundId,r=Object(a.useState)(!1),s=Object(w.a)(r,2),c=s[0],u=s[1],o=Object(a.useState)(""),d=Object(w.a)(o,2),b=d[0],p=d[1],j=Object(a.useState)(null),f=Object(w.a)(j,2),h=f[0],O=f[1],m=N(),v=m.getRound(e),x=v.tracks.find((function(t){return t.userId===m.id})),_=!m.isAuth||x||c?null:Object(n.jsx)("button",{className:"round__submit-btn",onClick:function(){u(!0)},children:"\u0421\u0434\u0430\u0442\u044c \u0442\u0440\u044d\u043a"}),g=function(){var t=Object(l.a)(i.a.mark((function t(r){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.next=3,G(e,b);case 3:"OK"===(n=t.sent).status?window.location.reload():O(n.error);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=c&&Object(n.jsxs)("form",{className:"round__submit-track-form",onSubmit:g,children:[Object(n.jsx)("input",{className:"round__submit-track-form-input",type:"text",required:!0,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u0440\u044d\u043a\u0430",onChange:function(t){p(t.target.value)}}),Object(n.jsx)("span",{className:"round__submit-track-error",children:h}),Object(n.jsx)("button",{className:"round__submit-btn",children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]}),k=(null===v||void 0===v?void 0:v.style)?Object(n.jsx)("span",{className:"round__title_style",children:null===v||void 0===v?void 0:v.style}):null,S=new Date(null===v||void 0===v?void 0:v.lastDay).toLocaleDateString("en-US",{day:"numeric",month:"long",year:"numeric"});return Object(n.jsxs)("div",{className:"round",children:[Object(n.jsxs)("div",{className:"round__header",children:[Object(n.jsxs)("div",{className:"round__title",children:[Object(n.jsxs)("span",{className:"round__title_number",children:["\u0420\u0430\u0443\u043d\u0434 #",null===v||void 0===v?void 0:v.number]})," ",Object(n.jsx)("span",{className:"round__title_theme",children:null===v||void 0===v?void 0:v.theme})," ",k]}),Object(n.jsxs)("span",{className:"round__last-date",children:["\u041f\u0440\u0438\u0435\u043c \u0442\u0440\u044d\u043a\u043e\u0432 \u0434\u043e ",S]})]}),Object(n.jsx)(M,{roundId:e}),Object(n.jsxs)("div",{className:"round__submit-track",children:[_,y]})]})}))),z=(r(29),Object(T.a)((function(){var t=N(),e=Object(d.g)(),r=function(){var e=Object(l.a)(i.a.mark((function e(){var r,n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:"OK"===(r=e.sent).status?(n=r.data,a=n.categories,s=n.rounds,t.updateBattleData(s,a)):console.log(r.error);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){r()}),[]);var s=function(){var e=Object(l.a)(i.a.mark((function e(r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:t.logout();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=Object(n.jsx)("button",{className:"header__btn",onClick:s,children:"Log Out"}),u=Object(n.jsx)("button",{className:"header__btn",onClick:function(){e("/login")},children:"Log In"}),o=t.isAuth?c:u,b=t.rounds.map((function(t,e){return Object(n.jsx)("div",{children:Object(n.jsx)(Z,{roundId:t.id})},e)}));return Object(n.jsxs)("div",{children:[Object(n.jsxs)("header",{className:"header",children:[Object(n.jsx)("span",{className:"header__username",style:{color:t.color},children:t.username}),o]}),Object(n.jsx)("div",{className:"body",children:b})]})})));r(30);var F=function(){var t=N();Object(a.useEffect)((function(){e()}),[]);var e=function(){var e=Object(l.a)(i.a.mark((function e(){var r,n,a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:"OK"===(r=e.sent).status?(n=r.data,a=n.id,s=n.username,c=n.color,t.login(a,s,c)):t.logout();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(d.c,{children:[Object(n.jsx)(d.a,{path:"/",element:Object(n.jsx)(z,{})}),Object(n.jsx)(d.a,{path:"/login",element:Object(n.jsx)(E,{})})]})})},Q=r(9);u.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(k,{children:Object(n.jsx)(Q.a,{children:Object(n.jsx)(F,{})})})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.5ce615fa.chunk.js.map